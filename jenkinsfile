node{

stage("checkoutcodegit")
{
git branch: 'development', credentialsId: 'e9236c04-35f7-478a-bb6d-ae659982319e',
url: 'https://github.com/nskpus/Test-web-project.git'
}
    def mavenhome= tool name:"maven3.6.3"
stage("build")
{
  sh "${mavenhome}/bin/mvn clean package"	

}

stage("executeSonarqubeReports")
{
  sh "${mavenhome}/bin/mvn sonar:sonar"	

}
stage("uploadArtifactory in nexus")
{
  sh "${mavenhome}/bin/mvn deploy"	

}
stage("Deploytomcatserver")
{
   sshagent(['65aa5c89-0cd4-4011-97e8-e428c61e71de'])
    {
      sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@52.66.202.192:/opt/apache-tomcat-9.0.37/webapps/"
    }
}

stage(){
emailext body: '''Regards,
Saidulu Naganaboina
9652233885''',
subject: 'Build over', 
to: 'nskp.us@gmail.com,saidulu.javax@gmail.com,sainaganaboina@gmail.com'
}

}	
